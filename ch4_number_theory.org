#+TITLE: Chapter 4: Number Theory

* Divisibility

** Definition: m divides n

$m\n \iff m > 0$ and $n = mk$ for some integer $k$

** Greatest Common Divisor

$\mathrm{gcd}(m,n) = \max\{k | k|m \mathrm{ and } k|n\}$

** Least Common Multiple

$\mathrm{lcm}(m, n) = \min\{k | k > 0, m | k and n | k\}$

** Euclid's Algorithm

$\gcd(0, n) = n$
$\gcd(m, n) = \gcd(n \mod m, m)$ for $m > 0$

#+begin_src python
def euclids_algo(m: int, n: int) -> int:
    if m < 0:
        return 0
    if m == 0:
        return n
    else:
        new_m = n % m
        return euclids_algo(new_m, m)


euclids_algo(12, 18)
euclids_algo(226, 430)
#+end_src

We can also extend it so that it will compute integers $m', n'$ satisfying:

$m'm + n'n = \gcd(m, n)$

** Mini-theorem

$k|m$ and $k|n \iff k | \gcd(m, n)$

** Sum Rule

$\Sigma_{m | n} a_m = \Sigma_{m | n} a_{n / m}$ where $n > 0, n \in \mathcal{N}$

** More General Sum Rule

$\Sigma_{m|n} a_m = \Sigma_k \Sigma_{m > 0} a_m [n = mk]$

** Interchanging Double Sums

$\Sigma_{m | n} \Sigma_{k | m} a_{k, m} = \Sigma_{k | n} \Sigma_{l | (n / k)} a_{k, kl}$

* Primes

A positive integer $p$ is called a prime if it has just 2 divisors, namely 1 and $p$.

** Fundamental Theorem of Arithmetic

Any positive integer $n$ can be written as a product of primes

$n = p_1 ... p_m = \Pi_{k = 1}^m p_k$ where $p_1 \leq ... \leq p_m$

moreover, the expansion above is unique

** Another Formulation of the Fundamental Theorem of Arithmetic

Every positive integer can be written uniquely in the form:

$n = \Pi_p p^{n_p}$ where each $n^p \geq 0$


The Formula above represents $n$ uniquely, so we can think of the sequence $<n_2, n_3, n_5, ...>$ as a number system for positive integers.

For example, the prime-exponent representation of 18 is $<1,2, 0, 0, ...>$ and the prime-exponent representation of 12 is $<2, 1, 0, 0, ...>$

** Prime-Exponent Multiplication

$k = mn \iff k_p = m_p + n_p$ for all $p$

** With Division

$m|n \iff m_p \leq n_p$ for all $p$

** Min and Max Trick

$k = \gcd(m, n) \iff k_p = \min(m_p, n_p)$ for all $p$

$k = \mathrm{lcm}(m, n) \iff k_p = \max(m_p, n_p)$ for all $p$

* Prime Examples

** Euclid Numbers

$e_n = e_1 e_2 ... e_{n - 1} + 1$ when $n \geq 1$

Alternatively stated

$e_n = 1 + \Pi_{i = 1}^n p_i = 1 + p_n \#$

where $p_n \#$ is the primorial (product of primes over the index)

Not all Euclid Numbers are prime, but they are all relatively prime to each other.
That is,

$\gcd(e_m, e_n) = 1$ when $m \neq n$

** Mersenne Numbers

Mersenne Numbers are numbers of the form $2^p - 1$

** Prime Number Theorem

$\pi(x) \sim \frac{x}{\ln x}$

* Factorial Factors

** Factorial

$n! = 1 \cdot 2 \cdot ... \cdot n = \Pi_{k=1}^n k$ for integer $n \geq 0$

** Factorial Growth is Exponential

$n^{n/2} \leq n! \leq \frac{(n + 1)^n}{2^n}$

** Stirling's Formula

$n! \sim \sqrt{2 \pi n}(\frac{n}{e})^n$

** Ruler Function

$\epsilon_p (n!) = \Sigma_{k \geq 1} \left\lfloor{\frac{n}{p^k}}\right\rfloor$

** Binarized Ruler Function

$\epsilon_2 (n!) = n - \nu_2(n)$

where $\nu_2(n)$ is the number of 1s in the binary representation of n.

* Relative Primality

** Relatively Prime Notation

$m \perp n \iff$ $m, n \in \mathcal{Z}$ and $\gcd(m, n) = 1$

** Division by gcd leads to relatively prime outputs

$m / \gcd(m, n) \perp n / \gcd(m, n)$

** Relative Primality w.r.t Prime Exponents

Where a prime exponent is this notation $<2, 1, 0, 0, ...>$ for 12

$m \perp n \iff \min(m_p, n_p) = 0$ for all $p$

Since $m_p, n_p$ are both non-negative, we can rewrite this as

$m \perp n \iff m_p n_p = 0$ for all $p$

** Split and Combine 2 $\perp$ relations with the same left-hand side

$k \perp m$ and $k \perp n \iff k \perp m n$

** Stern Brocot Tree

There is a beautiful way to construct the set of all nonnegative fractions $m/n$ with $m \perp n$ called the Stern-Brocot tree.

The idea is to start with 2 fractions $(\frac{0}{1}, \frac{1}{0})$ and then repeat the following operation as many times as desired:

Insert $\frac{m + m'}{n + n'}$ between the two adjacent fractions $\frac{m}{n}$ and $\frac{m'}{n'}$

The new fraction inserted is called the mediant.


#+DOWNLOADED: screenshot @ 2021-10-31 17:00:43
[[file:Relative_Primality/2021-10-31_17-00-43_screenshot.png]]

** The Farey Series of Order N

The Farey Series of order N is the set of all reduced fractions between 0 and 1 whose denominators are N or less, arranged in increasing order.

$\mathcal{F}_6 = \frac{0}{1}, \frac{1}{6}, \frac{1}{5}, \frac{1}{4}, \frac{1}{3}, \frac{2}{5}, \frac{1}{2}, \frac{3}{5}, \frac{2}{3}, \frac{3}{4}, \frac{4}{5}, \frac{5}{6}, \frac{1}{1}$

We can obtain $\mathcal{F}_N$ in general by starting with $\frac{0}{1}, \frac{1}{1}$ and then inserting mediants whenever it's possible to do so without getting a denominator that is too large. We don't miss any fractions in this way, because we know that the Stern-Brocot construction doesn't miss any, and because a mediant with denominator $\leq N$ is never formed from a fraction whose denominator is $> N$. In other words, $\mathcal{F}_N$ defines a subtree of the Stern-Brocot tree, obtained by pruning off unwanted branches.
